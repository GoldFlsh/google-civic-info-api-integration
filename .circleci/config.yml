version: 2.1
orbs:
  newman: postman/newman@1.0.0

jobs:
  checkout:
    steps:
      - checkout
  run-newman-collection:
    executor: newman/postman-newman-docker
    steps:
      - checkout
      - newman/newman-run:
          collection: ./postman/Google_Civic_Information_API.postman_collection.json
          environment: ./postman/credentials.postman_environment.json
          additional-options: --env-var API_KEY=${API_KEY_CI}

workflow:
  run_all_tests:
    jobs:
      - run-newman-collection
